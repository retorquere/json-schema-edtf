// see https://rawgit.com/zaggino/z-schema/master/benchmark/results.html for a list of schema engines

import { parse } from 'edtf'

export function validate(date, options) {
  if (typeof date !== 'string') return false

  try {
    parse(date, options)
    return true
  } catch (err) {
    return false
  }
}

export type Validator = (date: string) => boolean
/**
 * Formats to be used in `{ type: 'string', format: 'edtf/level-1' }` type JSON schemas
 */
export const formats: Record<string, Validator> = {
<%_ for (const seasonIntervals of [false, true]) { _%>
  <%_ for (const level of [0, 1, 2]) { _%>
  'edtf/level-<%= level %><%= seasonIntervals ? '+season-intervals' : '' %>': (date: string) => validate(date, { level: <%= level %><%= seasonIntervals ? ', seasonIntervals: true' : ''%> }),
  <%_ } _%>
<%_ } _%>
}
